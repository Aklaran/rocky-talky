# Rocky Talky log rotation configuration
# This file manages rotation of Rocky Talky application logs
#
# Installation:
# 1. Copy to ~/.config/logrotate.conf (or append to existing file)
# 2. Add a cron job or systemd timer to run logrotate:
#    - Cron: Add to crontab -e:
#      0 * * * * /usr/sbin/logrotate ~/.config/logrotate.conf --state ~/.local/state/logrotate.state
#    - Or use the systemd service installed by deploy.sh
#
# Manual rotation (if automatic setup not desired):
#    /usr/sbin/logrotate ~/.config/logrotate.conf --state ~/.local/state/logrotate.state --force

$HOME/.local/state/rocky-talky/rocky-talky.log {
    # Rotate when file reaches 10MB
    size 10M
    
    # Keep 3 rotated logs (plus the current one = 4 total)
    rotate 3
    
    # Don't error if log file is missing
    missingok
    
    # Don't rotate if empty
    notifempty
    
    # Compress rotated logs (except the most recent)
    compress
    delaycompress
    
    # Don't mail logs to anyone
    nomail
    
    # Truncate the original file in-place after creating a copy.
    # This avoids restarting the service (which kills active sessions).
    # The service keeps its file handle and writes to the now-empty file.
    copytruncate
}
